"use client";

import { useState } from "react";
import { ChevronDown } from "lucide-react";

const faqs = [
  {
    question: "Что позволяет делать Умный домофон?",
    answer: `
      Умный домофон позволяет:
      • принять видеовызов для открытия двери;
      • открыть дверь с помощью имеющейся аудиотрубки или смартфона;
      • открыть дверь с помощью пин-кода или брелка;
      • узнать, кто пытается попасть в квартиру, пока дома только дети или пожилые близкие.
    `,
  },
  {
    question: "Где можно скачать приложение?",
    answer: `Мобильное приложение Правительства Москвы «Электронный дом» можно скачать с официального сайта:  https://ed.mos.ru/, либо в Ru Store, RuMarket и App Market. Приложение бесплатное.`,
  },
  {
    question: "Как зарегистрироваться в приложении?",
    answer: `Вы можете войти, используя логин и пароль от  https://www.mos.ru/. Если у Вас пока нет аккаунта  https://www.mos.ru/, то нужно зарегистрироваться и внести свой адрес в соответствующем разделе, подтвердить его можно помощью номера лицевого счета плательщика  из ЕПД/ Единый платежный документ. 
            В некоторых случаях требуется проверка права собственности – подтвердить его можно прикрепив выписку из ЕГРН. Получить выписку можно в электронном виде  www.gosuslugi.ru/help/faq/egrn/180210 без посещения МФЦ.`,
  },
  {
    question: "Как долго устанавливают оборудование для Умного дома?",
    answer: `Мы установим все оборудование в течение 30 дней после получения Протокола собрания собственников жилья. Кворум должен составить не менее 50% + 1 голос, из числа которых не менее половины голосов должны быть ЗА переход на Умный домофон Айситипро. 
      До начала монтажных работ мы разместим объявления на дверях и в холлах подъездов, где будет указан временный код для входа в подъезд. После завершения установки панелей назначается день выдачи брелков. 
      Как правило, выдача производится у первого подъезда с 17:00 до 21:00. Жителям выдается по 3 брелка на каждую квартиру бесплатно (в случае коммунальных квартир – на каждый лицевой счет), дополнительные брелки можно оплатить и получить сразу же по цене 150 руб/шт. 
      В течение 30 календарных дней после выдачи брелков производится настройка аудиотрубок жителей.`
  },
  {
    question: "Использовать приложение безопасно?",
    answer: `Да, безопасно. Видео не записывается, не хранится и не передается. Все прочие данные зашифрованы и хранятся на защищенном сервере на территории РФ. Функция видеовызова удобна тем, что вызывающий не видит Вас на экране домофона.`
  },
  {
    question: "Что, если я не приду на выдачу брелков?",
    answer: `Брелки жителей, не успевших получить их в назначенный день, передаются либо Председателю правления многоквартирного дома (далее – Председатель) для ответственного хранения, либо в диспетчерский пункт Вашей управляющей компании. Способ определяется Председателем и доводится в объявлениях на дверях и в холлах подъездов.`
  },
  {
    question: "Как экстренные службы смогут попасть в дом?",
    answer: `Скорая помощь и другие экстренные службы могут, как и при обычных домофонах, попасть в квартиру, позвонив на аудиотрубку, либо зайти по коду, который житель сам сообщит при вызове (как указано выше – код можно заказать по телефону технической поддержки).
Родные пожилых лиц могут скачать приложение и подключить их квартиру к видеовызовам на собственный смартфон, даже не проживая совместно, чтобы оперативно узнать о приезде скорой помощи.
Работникам Управляющих компаний и Почты России выдаются специальные брелки.
Каждый брелок iCitypro привязан к конкретной квартире, «универсальных» брелков в целях безопасности не существует.`
  },
  {
    question: "Как купить дополнительный брелок?",
    answer: `Бесплатно на каждую квартиру выдается по 3 брелка  (в случае коммунальных квартир – на каждый лицевой счет), дополнительные брелки можно приобрести  по 150 руб/шт.`
  },
  {
    question: "Что, если отключится интернет или выключится свет?",
    answer: `При отсутствии интернета на мобильном устройстве прием видеовызовов и создание новых кодов будет невозможным. Весь остальной функционал будет работать (открытие брелком, кодом, созданным ранее, вызов на аудиотрубку). При отсутствии света Умный домофон Айситипро продолжит работу в течение 10 минут за счет внутреннего источника бесперебойного питания, затем, в случае если электроснабжение не восстановлено, отключается (как и любой другой домофон), дверь при этом разблокируется.`
  },
  {
    question: "А если домофон сломают?",
    answer: `В случае вандализма либо иных противоправных действий ремонт/замена Умный домофон Айситипро осуществляется бесплатно.
Обслуживание имеющихся домофонных линий также входит в сервисный сбор 68,54 руб/мес.`
  }
];

export default function FaqAccordion() {
  const [openIndex, setOpenIndex] = useState<number | null>(0);

  const toggle = (index: number) => {
    setOpenIndex(openIndex === index ? null : index);
  };

  return (
    <section className="mt-12">
      <div className="space-y-4">
        {faqs.map((faq, i) => {
          const isOpen = openIndex === i;
          const parts = faq.answer.split("•").map((p) => p.trim()).filter(Boolean);
          const intro = parts[0].includes("домофон") ? parts[0] : null;
          const bullets = parts.slice(intro ? 1 : 0);

          return (
            <div
              key={i}
              className={`bg-white border border-gray-100 rounded-xl shadow-sm transition-all duration-300 overflow-hidden ${
                isOpen ? "shadow-md" : "hover:shadow"
              }`}
            >
              {/* Заголовок */}
              <button
                onClick={() => toggle(i)}
                className={`w-full flex justify-between items-center text-left px-6 py-4 ${
                    isOpen ? "shadow-md" : "shadow-none"
                }`}
              >
                <span
                  className={`font-bold text-base ${
                    isOpen ? "text-black" : "text-gray-800"
                  }`}
                >
                  {i + 1} <span className="pl-8">{faq.question}</span>
                </span>
                <ChevronDown
                  className={`w-5 h-5 text-gray-500 transition-transform duration-300 ${
                    isOpen ? "rotate-180 text-gray-700" : "rotate-0"
                  }`}
                />
              </button>

              {/* Контент */}
              <div
                className={`transition-all duration-500 ease-in-out overflow-hidden ${
                  isOpen ? "max-h-[300px] opacity-100" : "max-h-0 opacity-0"
                }`}
              >
                <div className="px-6 py-5 pl-18 text-gray-500 text-sm leading-relaxed">
                  {intro && <p className="mb-2">{intro}</p>}

                  {bullets.length > 0 && (
                    <ul className="list-disc list-inside space-y-1 mt-1">
                      {bullets.map((item, idx) => (
                        <li key={idx}>{item}</li>
                      ))}
                    </ul>
                  )}
                </div>
              </div>
            </div>
          );
        })}
      </div>
    </section>
  );
}